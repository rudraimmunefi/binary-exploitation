## Everything I learned about FMT in general

#### Not-So vulnerable code:
```
#include <stdio.h>
int main(){
	char a[100];
	puts("Enter your name:");
	scanf("%s",a);
	printf("%s",a);
	puts("\nbye");
	return 0;
}
```

#### Vulnerable Code:

```
#include <stdio.h>
int main(){
	char a[100];
	puts("Enter your name:");
	scanf("%s",a);
	printf(a);
	puts("\nbye");
	return 0;
}
```
The major difference between the two code is passing of user input directly into the printf function.Variable *a* is passed to printf which is a user input and it can't be trusted and if passed with some format strings then the value from the stack would be leaked to the user.

#### Stack for Non Vuln code:

```
[------------------------------------stack-------------------------------------]
0000| 0xffffcf20 --> 0x8048651 --> 0xa007325 ('%s')
0004| 0xffffcf24 --> 0xffffcf38 ("AABB")
0008| 0xffffcf28 --> 0xf7fd0410 --> 0x80482b8 ("GLIBC_2.0")
0012| 0xffffcf2c --> 0x804851d (<main+23>:	add    ebx,0x1ae3)
0016| 0xffffcf30 --> 0x0 
0020| 0xffffcf34 --> 0x1 
0024| 0xffffcf38 ("AABB")
0028| 0xffffcf3c --> 0x0 
[------------------------------------------------------------------------------]
```

#### Stack for Vuln Code:

```
[------------------------------------stack-------------------------------------]
0000| 0xffffcfc0 --> 0xffffcfd8 --> 0xf7007825 
0004| 0xffffcfc4 --> 0xffffcfd8 --> 0xf7007825 
0008| 0xffffcfc8 --> 0xf7fd0410 --> 0x80482b8 ("GLIBC_2.0")
0012| 0xffffcfcc --> 0x804851d (<main+23>:	add    ebx,0x1ae3)
0016| 0xffffcfd0 --> 0x0 
0020| 0xffffcfd4 --> 0x1 
0024| 0xffffcfd8 --> 0xf7007825 
0028| 0xffffcfdc --> 0xc2 
[------------------------------------------------------------------------------]
```

#### General Stack Layout:

![alt text](https://github.com/rudrapwn/binary-exploitation/blob/master/screenshots/stack-layout-fmt.png?raw=true "General Stack Layout")

#### Working of printf() laymans terms:

printf manages a character pointer and an argument pointer. Character pointer points to the first character in the format string and argument pointer is pointer towards the first argument in stack.

If character pointer encounters any % sign followed by any format string char then the argument pointer is increased by one and is now pointing to a different location in stack.

Resource: https://www.youtube.com/watch?v=y5kcaqKYlqI&list=PLyqSpQzTE6M-q0Xgn0icEHvUS7WQxvenv&index=20


